import{S as R}from"./spreadsheet-CEHqqOgG.js";const h=["example.com","sample.net","testing.org","sample.com","testing.net","example.net"],b=[{id:1,name:"New York"},{id:2,name:"London"},{id:3,name:"Tokyo"},{id:4,name:"Paris"},{id:5,name:"Sydney"},{id:6,name:"Berlin"},{id:7,name:"Cairo"},{id:8,name:"Rio de Janeiro"},{id:9,name:"Moscow"},{id:10,name:"Beijing"}],m=[{id:1,name:"Sales",locationId:1},{id:2,name:"Marketing",locationId:3},{id:3,name:"Engineering",locationId:7},{id:4,name:"Finance",locationId:1},{id:5,name:"Human Resources",locationId:null},{id:6,name:"Legal",locationId:9},{id:7,name:"Customer Support",locationId:4},{id:8,name:"Research",locationId:8},{id:9,name:"IT",locationId:3},{id:10,name:"Management",locationId:10},{id:11,name:"Operations"},{id:12,name:"Customer Success"},{id:13,name:"Data Science"},{id:14,name:"Product Engineering"},{id:15,name:"Product Management"},{id:16,name:"Product Security"},{id:17,name:"Product Compliance"},{id:18,name:"Product Risk Management"},{id:19,name:"Product Audit"},{id:20,name:"Product Investigations"}];async function S(e){return new Promise(o=>{setTimeout(()=>{e.locationId?o(Array.from({length:e.locationId+1},(l,d)=>({id:d+1,name:`Checkout ${d+1}`}))):o([])},1e3+Math.random()*2e3)})}const x={id:{type:"number",label:"ID",readonly:!0,defaultValue:null},name:{type:"text",required:!0,maxlength:20,label:"Full Name",placeholder:"Enter full name"},email:{type:"email",required:!0,label:"Email Address",placeholder:"Enter email address"},dob:{type:"date",label:"Date of Birth",defaultValue:new Date().toISOString().split("T")[0]},locationId:{type:"select",label:"Location",values:b,placeholder:"Select location"},departmentId:{type:"select",label:"Department",values:m,disabled:e=>!e.locationId,filterValues:e=>[{id:null,name:"(Empty)"},...e.locationId?m.filter(o=>o.locationId===e.locationId):[]],placeholder:"Select department"},checkoutId:{type:"select",label:"Checkout",filterValues:S,placeholder:"Select One"},isRestricted:{type:"boolean",label:"Restricted",nullable:!0,defaultValue:!0},salary:{type:"number",label:"Salary"},notes:{type:"text",label:"Notes",multiline:!0,wordWrap:!0}};function C(e){const o=new Map(b.map(l=>[l.id,m.filter(d=>d.locationId===l.id)]));return Array.from({length:e},(l,d)=>{const u=Math.random()<.5?null:Math.floor(Math.random()*10)+1;let t=null;if(u){const n=o.get(u);n!=null&&n.length&&(t=n.length===1?n[0].id:n[Math.floor(Math.random()*n.length)].id)}return{id:d+1,name:`Person ${d+1}`,email:`person${d+1}@${h[Math.floor(Math.random()*h.length)]}`,dob:Math.random()<.5?null:new Date(Math.floor(Math.random()*1e10)).toISOString().split("T")[0],locationId:u,departmentId:t,isRestricted:Math.random()<.5,salary:Math.floor(Math.random()*1e5)+1e4,notes:`Notes for Person ${d+1}`}})}const f=window.location.search.includes("bigdata")?C(2e4):[{id:1,name:"Alice Johnson",email:"alice@example.com",dob:"1990-05-15",locationId:1,isRestricted:!1,salary:75e3,notes:"Team Lead"},{id:2,name:"Bob Smith",email:"bob@sample.net",dob:"1985-11-22",locationId:null,isRestricted:!0,salary:12e4,notes:"Senior Developer"},{id:3,name:"Charlie Brown",email:"charlie@testing.org","error:email":"User does not exist",dob:"1998-02-10",locationId:2,isRestricted:!1,salary:55e3,notes:""},{id:4,name:"Diana Prince",email:"diana@example.com",dob:"1980-08-08",locationId:5,isRestricted:!1,salary:95e3,notes:"Project Manager"},{id:5,name:"Ethan Hunt",email:"ethan@sample.net",dob:"1992-07-19",locationId:1,isRestricted:!0,salary:88e3,notes:"Needs access review"},{id:6,name:"Fiona Gallagher",email:"fiona@testing.org",dob:"1995-03-30",locationId:4,isRestricted:!1,salary:62e3,notes:"Junior Staff"},{id:7,name:"George Costanza",email:"george@example.com",dob:"1975-12-01",locationId:1,isRestricted:!1,salary:4e4,notes:"Part-time consultant"},{id:8,name:"Hannah Abbott",email:"hannah@sample.net",dob:"2000-01-25",locationId:2,isRestricted:!1,salary:58e3,notes:null},{id:9,name:"Ian Malcolm",email:"ian@testing.org",dob:"1978-09-14",locationId:null,isRestricted:!0,salary:15e4,notes:"Consultant - High Risk"},{id:10,name:"Jane Doe",email:"jane@example.com",dob:"1993-06-05",locationId:8,isRestricted:!1,salary:72e3,notes:"Standard user"},{id:11,name:"Kyle Broflovski",email:"kyle@sample.net",dob:"1999-05-26",locationId:9,isRestricted:!1,salary:68e3,notes:""},{id:12,name:"Laura Palmer",email:"laura@testing.org",dob:"1988-07-22",locationId:10,isRestricted:!0,salary:11e4,notes:"Requires monitoring"},{id:13,name:"Michael Scott",email:"michael@example.com",dob:"1970-03-15",locationId:1,isRestricted:!1,salary:85e3,notes:"Regional Manager"},{id:14,name:"Nadia Petrova",email:"nadia@sample.net",dob:"1982-11-08",locationId:9,isRestricted:!0,salary:13e4,notes:"Security clearance needed"},{id:15,name:"Oscar Martinez",email:"oscar@testing.org",dob:"1984-01-12",locationId:1,isRestricted:!1,salary:78e3,notes:"Accountant"},{id:16,name:"Pam Beesly",email:"pam@example.com",dob:"1989-03-25",locationId:1,isRestricted:!1,salary:6e4,notes:"Receptionist"},{id:17,name:"Quentin Coldwater",email:"quentin@sample.net",dob:"1996-09-01",locationId:3,isRestricted:!1,salary:65e3,notes:""},{id:18,name:"Rachel Green",email:"rachel@testing.org",dob:"1987-05-05",locationId:1,isRestricted:!1,salary:7e4,notes:"Fashion Buyer"},{id:19,name:"Steve Rogers",email:"steve@example.com",dob:"1920-07-04",locationId:1,isRestricted:!0,salary:2e5,notes:"Special Project"},{id:20,name:"Tony Stark",email:"tony@sample.net",dob:"1970-05-29",locationId:1,isRestricted:!0,salary:5e5,notes:"CEO - Restricted Access"},{id:21,name:"Ursula Buffay",email:"ursula@testing.org",dob:"1987-05-05",locationId:1,isRestricted:!1,salary:45e3,notes:"Waitress"},{id:22,name:"Victor Frankenstein",email:"victor@example.com",dob:"1790-10-10",locationId:6,isRestricted:!0,salary:99e3,notes:"Research - Confidential"},{id:23,name:"Wendy Darling",email:"wendy@sample.net",dob:"1900-01-01",locationId:2,isRestricted:!1,salary:52e3,notes:""},{id:24,name:"Xavier Thorpe",email:"xavier@testing.org",dob:"2002-04-18",locationId:4,isRestricted:!1,salary:61e3,notes:"Artist"},{id:25,name:"Yvonne Strahovski",email:"yvonne@example.com",dob:"1982-07-30",locationId:5,isRestricted:!0,salary:14e4,notes:"Agent - Top Secret"},{id:26,name:"Zachary Levi",email:"zachary@sample.net",dob:"1980-09-29",locationId:1,isRestricted:!1,salary:1e5,notes:"Actor"}].map(e=>{var o;return{...e,departmentId:e.locationId&&((o=m.find(l=>e.locationId===l.locationId))==null?void 0:o.id)||null}});function I(e){document.getElementById("data-size").textContent=e.toString()}function p(e,o){const l=document.getElementById("context-menu");l&&(l.style.left=`${e}px`,l.style.top=`${o}px`,l.classList.remove("hidden"))}function M(){const e=document.getElementById("context-menu");e&&e.classList.add("hidden")}document.addEventListener("DOMContentLoaded",()=>{var l,d,u;I(f.length);let e=null;try{e=new R("spreadsheet-container",x,[],{selectedRowBgColor:"#e0e7ff",onCellsUpdate:t=>{const n=e==null?void 0:e.getSelectedCell(),a=[],g=new Map(b.map(r=>[r.id,m.filter(c=>c.locationId===r.id).map(c=>c.id)]));for(const{rowIndex:r,columnKeys:c,data:s,oldData:i}of t)if(c.includes("email")&&s.email&&s.email.endsWith("@sample.net"))a.push({rowIndex:r,colKey:"loading:email",value:!0}),setTimeout(()=>{e==null||e.updateCells([{rowIndex:r,colKey:"loading:email",value:null},{rowIndex:r,colKey:"error:email",value:`Account ${s.email} does not exist`}]),(n==null?void 0:n.row)===r&&n.colKey==="email"&&(document.getElementById("error-container").textContent=`Account ${s.email} does not exist`)},2e3);else if(c.includes("locationId")||c.includes("departmentId")){if(!s.locationId&&s.departmentId)a.push({rowIndex:r,colKey:"departmentId",value:(i==null?void 0:i.departmentId)||null,flashError:"Wrong department"});else if(s.departmentId&&s.locationId){const y=g.get(+s.locationId);(!y||!y.includes(+s.departmentId))&&a.push({rowIndex:r,colKey:"departmentId",value:(i==null?void 0:i.departmentId)||null,flashError:"Wrong department"})}}a.length&&(e==null||e.updateCells(a))},onCellSelected:({rowData:t,colKey:n})=>{document.getElementById("error-container").textContent=t[`error:${n}`]||""},onRowDeleted:t=>{I((e==null?void 0:e.rowCount)||0),console.log("deleted rows",t)},onColumnDelete:(t,n)=>{console.log("deleting column",t),confirm(`Are you sure you want to delete column ${n.label}?`)&&(e==null||e.removeColumnByIndex(t))},onLazySearch:async({searchTerm:t})=>t?new Promise(n=>{setTimeout(()=>{n(m.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())))},2e3+Math.random()*1e3)}):null,onRowNumberContextMenu:({rowIndex:t,x:n,y:a})=>{console.log("row number context menu",t,n,a),p(n,a)},onColumnHeaderContextMenu:({colIndex:t,x:n,y:a})=>{console.log("column header context menu",t,n,a),p(n,a)},onCellContextMenu:({rowIndex:t,colKey:n,x:a,y:g})=>{console.log("cell context menu",t,n,a,g),p(a,g)},autoResizeRowHeight:!0,lineHeight:18,verbose:!0}),(()=>{const t=localStorage.getItem("cs-example-backup");if(!t){e==null||e.setData(f);return}if(confirm("Load data from local storage?")){const{data:n,columns:a}=JSON.parse(t),g=e==null?void 0:e.getColumns(),r=a.filter(c=>!g.includes(c));if(r.length){const c=new Set(n.map(i=>i[r[0]]).filter(i=>i)),s=Array.from(c).map(i=>m.find(y=>y.id===i)).filter(i=>i);e==null||e.addColumn(r[0],{type:"select",label:"Status",nullable:!0,lazySearch:!0,removable:!0,values:s})}e==null||e.setData(n);return}e==null||e.setData(f)})()}catch(t){console.error("Failed to initialize spreadsheet:",t);const n=document.getElementById("spreadsheet-container");n&&(n.innerHTML=`<p class="p-4 text-red-600">Error initializing spreadsheet: ${t instanceof Error?t.message:"Unknown error"}</p>`)}(l=document.getElementById("add-row"))==null||l.addEventListener("click",()=>{const t=e==null?void 0:e.addRow();I((t||0)+1)}),document.addEventListener("click",t=>{t.target!==document.getElementById("context-menu")&&M()}),(d=document.getElementById("add-column"))==null||d.addEventListener("click",()=>{e==null||e.addColumn("status",{type:"select",label:"Status",nullable:!0,lazySearch:!0,removable:!0})}),(u=document.getElementById("save"))==null||u.addEventListener("click",async()=>{const t=await(e==null?void 0:e.getData());console.log("data",t)});let o=!1;setInterval(async()=>{if(!o){o=!0,document.title="Saving...";try{const t=await(e==null?void 0:e.getData({keepErrors:!0,nonLoadingOnly:!0}));t!=null&&t.length&&localStorage.setItem("cs-example-backup",JSON.stringify({data:t,columns:e==null?void 0:e.getColumns()}))}catch(t){console.error("Failed to save data:",t)}o=!1,document.title="canvas-sheet"}},3e3)});
